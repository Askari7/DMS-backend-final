"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[745],{10745:(e,o,t)=>{t.r(o),t.d(o,{default:()=>x});var l=t(65043),a=t(15627),s=t(21261),i=t(94376),n=t(70610),d=t(47419),r=t(11645),c=t(89421),u=t(26412),v=t(22285),m=t(40854),p=t.n(m),h=t(78186),I=t(70579);const y=[{title:"ID",dataIndex:"id",key:"id"},{title:"MDR ID",dataIndex:"masterDocumentId",key:"masterDocumentId"},{title:"User ID",dataIndex:"userId",key:"userId"},{title:"Reviewer",dataIndex:"allowReview",key:"allowReview"},{title:"Approver",dataIndex:"allowApprove",key:"allowApprove"},{title:"Creator",dataIndex:"allowCreate",key:"allowCreate"}],A=[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}];function x(){var e,o;const[t,m]=(0,l.useState)(!1),[x,g]=(0,l.useState)([]),[k,w]=(0,l.useState)([]),[f,D]=(0,l.useState)(""),[b,j]=(0,l.useState)(""),[C,S]=(0,l.useState)(!1),[R,P]=(0,l.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[N,U]=(0,l.useState)([]),[z,M]=(0,l.useState)([]),[T,E]=(0,l.useState)([]),[_,q]=(0,l.useState)(""),J=()=>{j(""),m(!1)},O=async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/documents/permissions?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});U(o.data)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}};return(0,l.useEffect)((()=>{var e;P(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),O(),(async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/users?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,"&roleId=2"),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)});w(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/documents/mdr?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}}),t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title,DocumentPermissionId:null===e||void 0===e?void 0:e.DocumentPermissionId,departmentId:null===e||void 0===e?void 0:e.departmentId});g(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})()}),[]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(s.A,{title:"Create Permissions",width:416,centered:!0,visible:t,onCancel:J,footer:null,closeIcon:(0,I.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,I.jsxs)(i.A,{layout:"vertical",name:"basic",children:[(0,I.jsx)(i.A.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.A,{options:x,value:b,onChange:e=>j(e)})}),(0,I.jsx)(i.A.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.A,{options:k,value:f,onChange:e=>D(e)})}),(0,I.jsx)(i.A.Item,{label:"Permissions",name:"permissions",children:(0,I.jsx)(h.A.Group,{options:A,defaultValue:0,onChange:e=>{console.log("checked = ",e),E(e)}})}),(0,I.jsxs)(d.A,{children:[(0,I.jsx)(r.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,I.jsx)(c.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{try{var e,o;const t=await p().post("http://54.81.250.98:8083/api/documents/permissions",{masterDocumentId:b,userId:f,companyId:null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,createDocument:null===T||void 0===T?void 0:T.includes("Creator"),reviewDocument:null===T||void 0===T?void 0:T.includes("Reviewer"),approveDocument:null===T||void 0===T?void 0:T.includes("Approver")},{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(t),a.Ay.success(null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message),j(""),D(""),E([]),O(),m(!1)}catch(t){"Request failed with status code 403"==(null===t||void 0===t?void 0:t.message)&&a.Ay.error("Permission Denied to create document on this MDR")}})(),children:"Add"})}),(0,I.jsx)(r.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,I.jsx)(c.A,{block:!0,onClick:J,children:"Cancel"})})]})]})}),(0,I.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,I.jsx)(c.A,{type:"primary",onClick:()=>{m(!0)},disabled:1!=(null===R||void 0===R||null===(o=R.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,I.jsx)(u.A,{columns:y,dataSource:N,bordered:!0,title:()=>"All Documents Permissions",footer:()=>"You may filter Documents"})]})}}}]);
//# sourceMappingURL=745.c1d44e8d.chunk.js.map
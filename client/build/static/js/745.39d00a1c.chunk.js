"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[745],{10745:(e,o,a)=>{a.r(o),a.d(o,{default:()=>x});var t=a(65043),l=a(15627),s=a(21261),i=a(94376),n=a(33733),d=a(47419),r=a(11645),c=a(89421),u=a(26412),v=a(73754),m=a(40854),p=a.n(m),h=a(78186),I=a(70579);const y=[{title:"ID",dataIndex:"id",key:"id"},{title:"MDR ID",dataIndex:"masterDocumentId",key:"masterDocumentId"},{title:"User ID",dataIndex:"userId",key:"userId"},{title:"Reviewer",dataIndex:"allowReview",key:"allowReview"},{title:"Approver",dataIndex:"allowApprove",key:"allowApprove"},{title:"Creator",dataIndex:"allowCreate",key:"allowCreate"}],A=[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}];function x(){var e,o;const[a,m]=(0,t.useState)(!1),[x,g]=(0,t.useState)([]),[k,w]=(0,t.useState)([]),[j,C]=(0,t.useState)(""),[b,f]=(0,t.useState)(""),[D,S]=(0,t.useState)(!1),[R,P]=(0,t.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[N,U]=(0,t.useState)([]),[z,M]=(0,t.useState)([]),[T,E]=(0,t.useState)([]),[_,q]=(0,t.useState)(""),J=()=>{f(""),m(!1)},O=async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/documents/permissions?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});U(o.data)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}};return(0,t.useEffect)((()=>{var e;P(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),O(),(async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/users?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,"&roleId=2"),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const a=[];for(const e of null===o||void 0===o?void 0:o.data)a.push({value:null===e||void 0===e?void 0:e.id,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)});w(a)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/documents/mdr?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}}),a=[];for(const e of null===o||void 0===o?void 0:o.data)a.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title,DocumentPermissionId:null===e||void 0===e?void 0:e.DocumentPermissionId,departmentId:null===e||void 0===e?void 0:e.departmentId});g(a)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})()}),[]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(s.A,{title:"Create Permissions",width:416,centered:!0,visible:a,onCancel:J,footer:null,closeIcon:(0,I.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,I.jsxs)(i.A,{layout:"vertical",name:"basic",children:[(0,I.jsx)(i.A.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.A,{options:x,value:b,onChange:e=>f(e)})}),(0,I.jsx)(i.A.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.A,{options:k,value:j,onChange:e=>C(e)})}),(0,I.jsx)(i.A.Item,{label:"Permissions",name:"permissions",children:(0,I.jsx)(h.A.Group,{options:A,defaultValue:0,onChange:e=>{console.log("checked = ",e),E(e)}})}),(0,I.jsxs)(d.A,{children:[(0,I.jsx)(r.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,I.jsx)(c.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{try{var e,o;const a=await p().post("http://127.0.0.1:8083/api/documents/permissions",{masterDocumentId:b,userId:j,companyId:null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,createDocument:null===T||void 0===T?void 0:T.includes("Creator"),reviewDocument:null===T||void 0===T?void 0:T.includes("Reviewer"),approveDocument:null===T||void 0===T?void 0:T.includes("Approver")},{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(a),l.Ay.success(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message),f(""),C(""),E([]),O(),m(!1)}catch(a){"Request failed with status code 403"==(null===a||void 0===a?void 0:a.message)&&l.Ay.error("Permission Denied to create document on this MDR")}})(),children:"Add"})}),(0,I.jsx)(r.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,I.jsx)(c.A,{block:!0,onClick:J,children:"Cancel"})})]})]})}),(0,I.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,I.jsx)(c.A,{type:"primary",onClick:()=>{m(!0)},disabled:1!=(null===R||void 0===R||null===(o=R.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,I.jsx)(u.A,{columns:y,dataSource:N})]})}}}]);
//# sourceMappingURL=745.39d00a1c.chunk.js.map
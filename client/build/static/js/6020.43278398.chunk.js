"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[6020],{23415:(e,t,l)=>{l.d(t,{A:()=>n});l(14556);var r=l(91688),o=l(70579);const n=()=>{var e;const t=null===(e=localStorage)||void 0===e?void 0:e.getItem("user");return console.log(t,"loggin"),t?null:(0,o.jsx)(r.Redirect,{to:"/pages/authentication/login"})}},91439:(e,t,l)=>{l.d(t,{A:()=>d});var r=l(65043),o=l(21450),n=l(85369),a=l(40854),s=l.n(a),i=l(70579);const d=e=>{var t;let{employees:l}=e;const[a,d]=(0,r.useState)(JSON.parse(null===(t=localStorage)||void 0===t?void 0:t.getItem("user"))),[c,u]=(0,r.useState)();(0,r.useEffect)((()=>{m()}));const m=async()=>{try{var e;const t=await s().get("http://54.81.250.98:8083/api/users/company/?companyId=".concat(null===a||void 0===a||null===(e=a.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===a||void 0===a?void 0:a.accessToken}});console.log(t.data,"company name"),u(t.data)}catch(t){console.error("Error fetching documents:",null===t||void 0===t?void 0:t.message)}};console.log(l,"employees");const p=(e,t)=>[...e.values()].find((e=>null===e.department&&null===t.department||5===t.roleId&&e.department===t.department?e.roleId===t.roleId-1:5===t.roleId&&"Piping"===t.department?1===e.roleId:4===t.roleId&&"Process"===t.department?2===e.roleId&&"Process"===e.department:2===t.roleId||e.department===t.department?e.roleId===t.roleId-1:5===t.roleId&&"Instrumentation"===t.department&&1===e.roleId)),h=e=>{const t=0===e.children.length;return(0,i.jsxs)(o.n,{label:(0,i.jsxs)("div",{style:{backgroundColor:(e=>{switch(e){case 1:return"#FFD700";case 2:return"#87CEEB";case 3:return"#90EE90";case 4:return"#FFA07A";case 5:return"#DDA0DD";default:return"#FFFFFF"}})(e.roleId),padding:"4px",borderRadius:"16px",fontWeight:"bold",cursor:t?"default":"pointer"},children:[e.lastName,"-",e.department,"-",e.roleTitle,t&&(0,i.jsx)(n.sHz,{style:{marginLeft:"2px",fontSize:"20px",color:"#008000"}})]}),children:[e.children.map((e=>h(e)))," "]},e.id.toString())};return(0,i.jsx)("div",{style:{overflowX:"auto"},children:(0,i.jsx)(o.P,{label:(0,i.jsx)("div",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:2==a.user.roleId?a.user.department:c}),children:(e=>{const t=new Map;e.forEach((e=>{t.set(e.id,{...e,children:[]})})),console.log(t,"employeeMap");const l=[];return t.forEach((e=>{const r=e.roleId,o=e.department;if(2==a.user.roleId)if(o&&2===r)l.push(e);else{const l=p(t,e);l&&l.children.push(e)}else if(o||1!==r){const l=p(t,e);l&&l.children.push(e)}else l.push(e)})),console.log(l,"tree"),l})(l).map((e=>h(e)))})})}},26020:(e,t,l)=>{l.r(t),l.d(t,{default:()=>k});var r=l(65043),o=l(91688),n=l(60521),a=l(64435),s=l(89421),i=l(15627),d=l(21261),c=l(94376),u=l(70610),m=l(78186),p=l(47419),h=l(11645),g=l(26412),v=l(22285),x=l(40854),y=l.n(x),f=l(23415),I=l(70579);var j=l(91439);var A=l(62058),S=l(16854),b=l.n(S);function k(){var e,t,l,x;const[S,k]=(0,r.useState)(""),[E,C]=(0,r.useState)(""),D=(0,r.useRef)(null),w=(0,o.useLocation)(),[N,T]=(0,r.useState)(!0),[z,F]=(0,r.useState)([]),[P,J]=(0,r.useState)(""),[O,R]=(0,r.useState)(null),[_,H]=(0,r.useState)([]),[L,q]=(0,r.useState)(!1),[U,B]=(0,r.useState)(!1),[W,X]=(0,r.useState)(""),[K,M]=(0,r.useState)(""),[Q,G]=(0,r.useState)(""),[V,Y]=(0,r.useState)(""),Z=/\S+@\S+\.\S+/.test(W),[$,ee]=(0,r.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[te,le]=(0,r.useState)([]),[re,oe]=(0,r.useState)([]),[ne,ae]=(0,r.useState)(!1),se=(null===(t=w.state)||void 0===t?void 0:t.users)||null;console.log(se,"users");(0,r.useEffect)((()=>{const e=setTimeout((()=>{F(_.map((e=>e.label))),T(!1)}),1e3);return()=>clearTimeout(e)}),[_]);const ie=()=>{q(!1)},de=()=>{B(!1)},ce=(e,t,l)=>{t(),k(e[0]),C(l)},ue=e=>({filterDropdown:t=>{let{setSelectedKeys:l,selectedKeys:r,confirm:o,clearFilters:i,close:d}=t;return(0,I.jsxs)("div",{style:{padding:8},children:[(0,I.jsx)(n.A,{ref:D,placeholder:"Search ".concat(e),value:r[0],onChange:e=>l(e.target.value?[e.target.value]:[]),onPressEnter:()=>ce(r,o,e),style:{marginBottom:8,display:"block"}}),(0,I.jsxs)(a.A,{children:[(0,I.jsx)(s.A,{type:"primary",onClick:()=>ce(r,o,e),icon:(0,I.jsx)(A.A,{}),size:"small",style:{width:90},children:"Search"}),(0,I.jsx)(s.A,{onClick:()=>i&&(e=>{e(),k("")})(i),size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:e=>(0,I.jsx)(A.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(t,l)=>l[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.select()}),100)},render:t=>E===e?(0,I.jsx)(b(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[S],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),me=[{title:"Name",dataIndex:"firstName",key:"firstName",...ue("firstName")},{title:"Department",dataIndex:"department",key:"department",...ue("department")},{title:"Role",dataIndex:"roleTitle",key:"roleTitle",filters:[{text:"Lead",value:"Head"},{text:"Senior Engineer",value:"Senior"},{text:"Junior Engineer",value:"Junior"},{text:"Designer",value:"Designer"}],onFilter:(e,t)=>t.roleTitle===e},{title:"Reporting To",dataIndex:"reported_to",key:"reported_to",...ue("reported_to")},{title:"Email",dataIndex:"email",key:"email",...ue("email")},{title:"Action",key:"action",render:(e,t)=>(0,I.jsx)(a.A,{size:"middle",children:(0,I.jsx)("a",{children:"Delete"})})}],pe=async()=>{console.log($.user.roleId,"roleId");try{if(2==$.user.roleId){var e;const t=await y().get("http://54.81.250.98:8083/api/users?companyId=".concat(null===$||void 0===$||null===(e=$.user)||void 0===e?void 0:e.companyId,"&departmentId=").concat($.user.departmentId),{headers:{Authorization:null===$||void 0===$?void 0:$.accessToken}});le(t.data),oe(t.data)}else{var t;const e=await y().get("http://54.81.250.98:8083/api/users?companyId=".concat(null===$||void 0===$||null===(t=$.user)||void 0===t?void 0:t.companyId),{headers:{Authorization:null===$||void 0===$?void 0:$.accessToken}});console.log(e.data);const l=["Head of Department","Senior Engineer","Junior Engineer","Designer/Draughtsmen"];e.data.sort(((e,t)=>l.indexOf(e.roleTitle)-l.indexOf(t.roleTitle))),le(e.data),oe(e.data),console.log("response",e.data)}}catch(l){console.error("Error fetching documents:",null===l||void 0===l?void 0:l.message)}},he=e=>{const t=re.filter((t=>t.department===e)),l=["Head of Department","Senior Engineer","Junior Engineer","Designer/Draugthsmen"];t.sort(((e,t)=>l.indexOf(e.roleTitle)-l.indexOf(t.roleTitle))),console.log("filter",t),le(t)};return(0,r.useEffect)((()=>{var e;ee(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),se?le(se):((async()=>{try{var e;const t=await y().get("http://54.81.250.98:8083/api/departments?companyId=".concat(null===$||void 0===$||null===(e=$.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===$||void 0===$?void 0:$.accessToken}}),l=[];for(const e of null===t||void 0===t?void 0:t.data)l.push({value:{id:null===e||void 0===e?void 0:e.id,title:null===e||void 0===e?void 0:e.title},label:null===e||void 0===e?void 0:e.title});console.log("departments",l),H(l)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}})(),pe())}),[]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(d.A,{title:"Add User",width:416,centered:!0,visible:L,onCancel:ie,footer:null,closeIcon:(0,I.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,I.jsxs)(c.A,{layout:"vertical",name:"basic",children:[(0,I.jsx)(c.A.Item,{label:"First Name",name:"firstName",rules:[{required:!0,message:"Please input your firstName!"}],children:(0,I.jsx)(n.A,{value:Q,onChange:e=>G(e.target.value)})}),(0,I.jsx)(c.A.Item,{label:"Last Name",name:"lastName",rules:[{required:!0,message:"Please input your lastName!"}],children:(0,I.jsx)(n.A,{value:V,onChange:e=>Y(e.target.value)})}),(0,I.jsx)(c.A.Item,{label:"E-mail :",name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}],children:(0,I.jsx)(n.A,{id:"email",value:W,onChange:e=>X(e.target.value)})}),(0,I.jsx)(c.A.Item,{label:"Role",name:"role",children:(0,I.jsx)(u.A,{defaultValue:"",options:[{value:"head",label:"Head"},{value:"seniorEngineer",label:"Senior Engineer"},{value:"juniorEngineer",label:"Junior Engineer"},{value:"designer",label:"Designer/Draftsmen"}],value:K,onChange:e=>M(e)})}),(0,I.jsx)(c.A.Item,{label:"Select Department",rules:[{required:!0,message:"Please select one department!"}],children:(0,I.jsx)(m.A.Group,{options:_,value:P,onChange:J})}),(0,I.jsxs)(p.A,{children:[(0,I.jsx)(h.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,I.jsx)(s.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{try{var e,t;const l={head:"2",seniorEngineer:"3",juniorEngineer:"4",designer:"5"};console.log("selectedDeparment",P),console.log("role",K),console.log(P.id,P.title,"checking");const r=await y().post("http://54.81.250.98:8083/api/users",{roleId:l[K],companyId:null===$||void 0===$||null===(e=$.user)||void 0===e?void 0:e.companyId,departmentId:P[0].id,department:P[0].title,email:W,firstName:Q,lastName:V},{headers:{Authorization:null===$||void 0===$?void 0:$.accessToken}});console.log(r),i.Ay.success(null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),pe(),ie()}catch(l){console.error("Error adding user:",l)}})(),disabled:!(W.length&&Q.length&&V.length&&Z),className:W.length&&Q.length&&V.length&&Z?"":"disabled-button",children:"Add"})}),(0,I.jsx)(h.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,I.jsx)(s.A,{block:!0,onClick:ie,children:"Cancel"})})]})]})}),(0,I.jsxs)(d.A,{title:"Departments",width:416,centered:!0,visible:U,onCancel:de,footer:null,closeIcon:(0,I.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:[(0,I.jsx)(s.A,{size:"default",type:"primary",onClick:()=>(de(),void le(re)),style:{margin:"8px"},children:"All Departments"}),N?_.map((e=>(0,I.jsx)(s.A,{loading:!0,size:"default",style:{margin:"8px"},children:e.label},e.label))):z.map((e=>(0,I.jsx)(s.A,{size:"default",style:{margin:"8px"},onClick:()=>(e=>{R(e),de(),he(e)})(e),type:O===e?"primary":"default",children:e},e)))]}),(0,I.jsxs)("div",{style:{textAlign:"right",marginBottom:"16px"},children:[1==(null===$||void 0===$||null===(l=$.user)||void 0===l?void 0:l.roleId)&&(0,I.jsx)(s.A,{type:"primary",onClick:()=>{q(!0)},children:"Add User"}),(0,I.jsx)(s.A,{type:"primary",onClick:()=>{ae(!0)},onDoubleClick:()=>{ae(!1)},style:{margin:"4px"},children:"User Tree"})]}),ne?(0,I.jsx)("div",{style:{overflowX:"auto",width:"1300px"},children:2===(null===$||void 0===$||null===(x=$.user)||void 0===x?void 0:x.roleId)&&se?(0,I.jsx)(j.A,{employees:se}):(0,I.jsx)(j.A,{employees:re})}):(0,I.jsx)("div",{style:{overflowX:"auto"},children:(0,I.jsx)(g.A,{dataSource:te,columns:me,title:()=>"All Users",footer:()=>"You may filter users based on department and roles"})}),(0,I.jsx)(f.A,{})]})}}}]);
//# sourceMappingURL=6020.43278398.chunk.js.map
"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[2001],{23415:(e,t,l)=>{l.d(t,{A:()=>o});l(14556);var a=l(91688),s=l(70579);const o=()=>{var e;const t=null===(e=localStorage)||void 0===e?void 0:e.getItem("user");return console.log(t,"loggin"),t?null:(0,s.jsx)(a.Redirect,{to:"/pages/authentication/login"})}},92001:(e,t,l)=>{l.r(t),l.d(t,{default:()=>E});var a=l(65043),s=l(86904),o=l(94376),n=l(60521),i=l(64435),r=l(89421),d=l(83557),c=l(75932),u=l(15627),m=l(21261),p=l(70610),h=l(78186),v=l(26512),j=l(47419),x=l(11645),g=l(43886),A=l(73754),y=l(40854),f=l.n(y),I=l(91688),C=l(23415),k=l(62058),S=l(16854),b=l.n(S),D=l(7313),N=l(70579);const P=e=>{let{percentage:t}=e;return console.log("Percentage:",t),(0,N.jsx)(j.A,{justify:"center",align:"middle",style:{width:180},children:(0,N.jsx)(D.A,{percent:t,size:"small"})})};const w=(0,l(59662).A)((0,N.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Create");var z=l(45069),F=l(208);function E(){var e,t;const[l,y]=(0,a.useState)(""),[S,D]=(0,a.useState)(""),E=(0,a.useRef)(null),[V,q]=(0,a.useState)(),[O,H]=(0,a.useState)([]),[L,M]=(0,a.useState)(""),[B,Q]=(0,a.useState)(!1),[R,U]=(0,a.useState)(!1),[_,G]=(0,a.useState)(""),[J,K]=(0,a.useState)(""),[Y,W]=(0,a.useState)(""),[X,Z]=(0,a.useState)(""),[$,ee]=(0,a.useState)(""),[te,le]=(0,a.useState)([]),[ae,se]=(0,a.useState)(""),[oe,ne]=(0,a.useState)(""),[ie,re]=(0,a.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[de,ce]=(0,a.useState)([]),[ue,me]=(0,a.useState)([]),[pe,he]=(0,a.useState)(!1),[ve,je]=(0,a.useState)(null),[xe,ge]=s.A.useNotification(),[Ae]=o.A.useForm(),[ye,fe]=(0,a.useState)([]),[Ie,Ce]=(0,a.useState)([]),[ke,Se]=(0,a.useState)([]),[be,De]=(0,a.useState)([]),[Ne,Pe]=(0,a.useState)([]),[we]=o.A.useForm(),[ze,Fe]=(0,a.useState)(!1),[Ee,Te]=(0,a.useState)(),[Ve,qe]=(0,a.useState)(""),Oe=(0,I.useHistory)(),[He]=o.A.useForm(),Le=()=>{Oe.push("./mdr")},Me=()=>{he(!1)},Be=(e,t,l)=>{t(),y(e[0]),D(l)},Qe=e=>({filterDropdown:t=>{let{setSelectedKeys:l,selectedKeys:a,confirm:s,clearFilters:o,close:d}=t;return(0,N.jsxs)("div",{style:{padding:8},children:[(0,N.jsx)(n.A,{ref:E,placeholder:"Search ".concat(e),value:a[0],onChange:e=>l(e.target.value?[e.target.value]:[]),onPressEnter:()=>Be(a,s,e),style:{marginBottom:8,display:"block"}}),(0,N.jsxs)(i.A,{children:[(0,N.jsx)(r.A,{type:"primary",onClick:()=>Be(a,s,e),icon:(0,N.jsx)(k.A,{}),size:"small",style:{width:90},children:"Search"}),(0,N.jsx)(r.A,{onClick:()=>o&&(e=>{e(),y("")})(o),size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:e=>(0,N.jsx)(k.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(t,l)=>l[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.select()}),100)},render:t=>S===e?(0,N.jsx)(b(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[l],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),Re=(d.A,d.A.Item,d.A.Item,d.A.Item,[{title:"Project Code",dataIndex:"code",key:"code",...Qe("code")},{title:"Project ",dataIndex:"title",key:"title",...Qe("title")},{title:"Department ",dataIndex:"departmentTitle",key:"departmentTitle",...Qe("departmentTitle")},{title:"Client",dataIndex:"clientName",key:"clientName",...Qe("clientName")},{title:"Start Date",dataIndex:"startedDate",key:"startedDate",sorter:(e,t)=>new Date(e.startedDate.split("/").reverse().join("/"))-new Date(t.startedDate.split("/").reverse().join("/"))},{title:"Expected End Date",dataIndex:"endedDate",key:"endedDate",sorter:(e,t)=>new Date(e.endedDate.split("/").reverse().join("/"))-new Date(t.endedDate.split("/").reverse().join("/"))},{title:"Status",key:"status",dataIndex:"status",filters:[{text:"Initialized",value:"Initialized"},{text:"Ongoing",value:"Ongoing"},{text:"Completed",value:"Completed"}],onFilter:(e,t)=>t.status===e},{title:"Progress",key:"percentage",render:(e,t)=>(0,N.jsx)(i.A,{children:null!==t.percentage?(0,N.jsx)(P,{percentage:t.percentage.toFixed(1)}):null})},{title:"Action",key:"action",render:(e,t)=>{var l,a,s;return(0,N.jsxs)(i.A,{size:"middle",children:[(0,N.jsx)(c.A,{title:"Create MDR",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(w,{}),disabled:1!==(null===ie||void 0===ie||null===(l=ie.user)||void 0===l?void 0:l.roleId),onClick:Le})}),(0,N.jsx)(c.A,{title:"Update Project",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(F.A,{}),disabled:1!==(null===ie||void 0===ie||null===(a=ie.user)||void 0===a?void 0:a.roleId),onClick:()=>Je(t)})}),(0,N.jsx)(c.A,{title:"Delete",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(z.A,{}),disabled:1!==(null===ie||void 0===ie||null===(s=ie.user)||void 0===s?void 0:s.roleId),onClick:()=>(e=>{je(e),he(!0)})(t)})})]})}}]),Ue=()=>{ne(""),se(""),G(""),W(""),M(""),le([]),Q(!1)},_e=async()=>{if(!_||!Y)return void s.A.error({message:"Validation Error",description:"Please fill in all required fields.",style:{backgroundColor:"#f5222d",color:"#fff"}});const e=O.map((e=>{const t=Ie.find((t=>t.id===e));return{suffix:t?t.suffix:null,title:t?t.title:null}}));try{var t,l,a,o;const n=await f().post("http://127.0.0.1:8083/api/projects/",{title:_,departmentId:O,departments:e,status:"Initialized",noOfUsers:0,clientId:Y,code:oe,companyId:null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.companyId,authorId:null===ie||void 0===ie||null===(l=ie.user)||void 0===l?void 0:l.id,authorName:"".concat(null===ie||void 0===ie||null===(a=ie.user)||void 0===a?void 0:a.firstName," ").concat(null===ie||void 0===ie||null===(o=ie.user)||void 0===o?void 0:o.lastName),startedDate:X,endedDate:$},{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log(n),Q(!1),Ge(),s.A.success({message:"Successfully Created",description:"".concat(n.data.message),style:{backgroundColor:"#52c41a",color:"#fff"}})}catch(i){var n;409===(null===(n=i.response)||void 0===n?void 0:n.status)?s.A.error({message:"Conflict Error",description:"A project with this name or code already exists. Please choose a different name or code.",style:{backgroundColor:"#f5222d",color:"#fff"}}):s.A.error({message:"Error",description:"An error occurred while adding the project. Please try again.",style:{backgroundColor:"#f5222d",color:"#fff"}})}},Ge=async()=>{try{var e,t;const l=await f().get("http://127.0.0.1:8083/api/projects?companyId=".concat(null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId,"&roleId=").concat(null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.roleId,"&id=").concat(null===ie||void 0===ie?void 0:ie.user.id,"&firstName=").concat(null===ie||void 0===ie?void 0:ie.user.firstName),{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log("Project response data",l.data);const a=l.data.map((e=>{const t=new Date(e.startedDate).toLocaleDateString("en-GB"),l=new Date(e.endedDate).toLocaleDateString("en-GB");return console.log(e.clientId,"Yaha aya"),{...e,startedDate:t,endedDate:l}}));console.log("Project response data",a);const s=null===ie||void 0===ie?void 0:ie.user.departmentId;null===ie||void 0===ie||ie.user.roleId;console.log(s,"userId");const o=a.filter((e=>0==e.removed));ce(o),me(a);const n=[];for(const e of null===l||void 0===l?void 0:l.data)n.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});console.log(n),Se(n)}catch(l){console.error("Error fetching projects:",null===l||void 0===l?void 0:l.message)}},Je=e=>{Te(e),He.setFieldsValue({id:e.id,title:e.title,code:e.code}),Fe(!0)},Ke=()=>{Fe(!1)};(0,a.useEffect)((()=>{var e;re(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),(async()=>{try{var e;const l=await f().get("http://127.0.0.1:8083/api/clients?companyId=".concat(null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}}),a=new Set,s={};var t=null===l||void 0===l?void 0:l.data.reduce(((e,t)=>(a.has(t.companyName)||(a.add(t.com),e.push({value:t.id,label:t.companyName,name:t.companyName}),s[t.id]=t.companyName),e)),[]);console.log(t,"options Aye hain"),console.log(s,"optionName Aye hain"),De(t),Pe(s)}catch(l){console.error("Error fetching departments:",null===l||void 0===l?void 0:l.message)}})(),(async()=>{try{var e;const t=await f().get("http://127.0.0.1:8083/api/departments?companyId=".concat(null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log(t.data,"data agaya");const l=[],a=[];for(const e of null===t||void 0===t?void 0:t.data)l.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title}),a.push({id:null===e||void 0===e?void 0:e.id,title:null===e||void 0===e?void 0:e.title,suffix:null===e||void 0===e?void 0:e.suffix});Ce(a),fe(l)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}})(),Ge()}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(m.A,{title:"Add Project",width:416,centered:!0,visible:B,onCancel:Ue,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{layout:"vertical",name:"basic",onFinish:()=>{Ae.validateFields().then((e=>{_e(),Ae.resetFields()}))},form:Ae,children:[(0,N.jsx)(o.A.Item,{label:"Project Code",name:"projCode",rules:[{required:!0,message:"Please Add Project Code"}],children:(0,N.jsx)(n.A,{value:J,onChange:e=>ne(e.target.value)})}),(0,N.jsx)(o.A.Item,{label:"Project Name",name:"projName",rules:[{required:!0,message:"Please Add Project Name"}],children:(0,N.jsx)(n.A,{value:_,onChange:e=>G(e.target.value)})}),(0,N.jsx)(o.A.Item,{label:"Client",name:"clientEmail",rules:[{required:!0,message:"Please select Client"}],children:(0,N.jsx)(p.A,{options:be,value:Y,onChange:e=>W(e)})}),(0,N.jsx)(o.A.Item,{label:"Departments",name:"departmentIds",rules:[{required:!0,message:"Please select at least one department"}],children:(0,N.jsx)(h.A.Group,{options:ye,value:O,onChange:H})}),(0,N.jsx)(o.A.Item,{label:"Start Date",name:"startedDate",rules:[{required:!0,message:"Please select start date"}],children:(0,N.jsx)(v.A,{style:{width:"100%"},onChange:e=>{Z(e)}})}),(0,N.jsx)(o.A.Item,{label:"End Date",name:"endedDate",rules:[{required:!0,message:"Please select end date"}],children:(0,N.jsx)(v.A,{style:{width:"100%"},onChange:e=>{ee(e)}})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",children:"Add"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Ue,children:"Cancel"})})]})]})}),(0,N.jsx)(m.A,{title:"Update Project",width:416,centered:!0,visible:ze,onCancel:Ke,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{form:He,layout:"vertical",onFinish:async()=>{try{const e=await f().put("http://127.0.0.1:8083/api/projects?companyId=".concat(null===ie||void 0===ie?void 0:ie.user.companyId,"&id=").concat(He.getFieldValue("id")),{title:He.getFieldValue("title"),code:He.getFieldValue("code")},{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});u.Ay.success(e.data.message),Ke(),Ge()}catch(e){console.error("Error updating departments:",null===e||void 0===e?void 0:e.message)}},children:[(0,N.jsx)(o.A.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please enter the project title"}],children:(0,N.jsx)(n.A,{placeholder:"Enter Project title",onChange:e=>He.setFieldsValue({title:e.target.value})})}),(0,N.jsx)(o.A.Item,{label:"Project Code",name:"code",rules:[{required:!0,message:"Please enter Project code"}],children:(0,N.jsx)(n.A,{placeholder:"Enter Project code",onChange:e=>He.setFieldsValue({code:e.target.value})})}),(0,N.jsx)(o.A.Item,{children:(0,N.jsx)(r.A,{type:"primary",htmlType:"submit",block:!0,children:"Update"})})]})}),(0,N.jsxs)(m.A,{title:"Delete Project",width:416,centered:!0,visible:pe,onCancel:Me,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:[(0,N.jsx)("div",{children:(0,N.jsx)("p",{children:"Are you sure you want to delete this?"})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",danger:!0,onClick:()=>(async e=>{const t=e.id;console.log(t);const l=await f().delete("http://127.0.0.1:8083/api/users?delete=3&recordId=".concat(e.id),{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});u.Ay.success(l.data.message),Me(),Ge()})(ve),children:"Delete"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Me,children:"Cancel"})})]})]}),(0,N.jsx)(m.A,{title:"Document Permissions",width:416,centered:!0,visible:R,onCancel:()=>{U(!1)},footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{layout:"vertical",name:"basic",children:[(0,N.jsx)(o.A.Item,{label:"Project Name",name:"projectId",children:(0,N.jsx)(p.A,{options:ke,value:Ve,onChange:e=>qe(e)})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>_e(),children:"Add"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Ue,children:"Cancel"})})]})]})}),(0,N.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:1==(null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.roleId)&&(0,N.jsx)(r.A,{type:"primary",onClick:()=>{Q(!0)},children:"Add Project"})}),(0,N.jsx)(g.A,{bordered:!0,size:"middle",title:()=>"All Project Details",footer:()=>"You may filter Projects",columns:Re,dataSource:T(de)}),(0,N.jsx)(C.A,{})]})}const T=e=>{const t={};e.forEach((e=>{const l=e.title;t[l]?t[l].departmentNames.push(e.departmentName+","):t[l]={...e,departmentNames:[e.departmentName+","]}}));return Object.values(t).map((e=>({...e,departmentName:e.departmentNames.join("")})))}},45069:(e,t,l)=>{l.d(t,{A:()=>o});var a=l(59662),s=l(70579);const o=(0,a.A)((0,s.jsx)("path",{d:"M16 9v10H8V9zm-1.5-6h-5l-1 1H5v2h14V4h-3.5zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2z"}),"DeleteOutlined")}}]);
//# sourceMappingURL=2001.5aa45564.chunk.js.map
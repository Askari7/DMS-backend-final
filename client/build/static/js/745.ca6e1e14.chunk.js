"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[745],{10745:(e,o,l)=>{l.r(o),l.d(o,{default:()=>A});var t=l(65043),s=l(94376),a=l(15627),i=l(21261),n=l(79940),d=l(47419),r=l(11645),c=l(89421),u=l(43886),v=l(73754),m=l(40854),p=l.n(m),h=l(78186),y=l(70579);const I=[{title:"Project",dataIndex:"project",key:"project"},{title:"MDR ID",dataIndex:"masterDocumentId",key:"masterDocumentId"},{title:"User ID",dataIndex:"userId",key:"userId"},{title:"Reviewer",dataIndex:"allowReview",key:"allowReview"},{title:"Approver",dataIndex:"allowApprove",key:"allowApprove"},{title:"Uploader/Creator",dataIndex:"allowCreate",key:"allowCreate"}],g=[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}];function A(){var e,o;const[l,m]=(0,t.useState)(!1),[A,x]=(0,t.useState)([]),[f,j]=(0,t.useState)([]),[w,k]=(0,t.useState)([]),[b,S]=(0,t.useState)([]),[C,D]=(0,t.useState)(""),[R,$]=(0,t.useState)(""),[P,z]=(0,t.useState)(""),[N]=s.A.useForm(),[T,U]=(0,t.useState)(""),[E,F]=(0,t.useState)(!1),[M,q]=(0,t.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[_,J]=(0,t.useState)([]),[O,B]=(0,t.useState)([]),[G,Q]=(0,t.useState)([]),[V,Y]=(0,t.useState)(""),H=()=>{$(""),U(""),m(!1)},K=async()=>{try{var e;const o=await p().get(`https://novacon.live/api/documents/permissions?companyId=${null===M||void 0===M||null===(e=M.user)||void 0===e?void 0:e.companyId}`,{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}});console.log(o.data),J(o.data)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}};(0,t.useEffect)((()=>{var e;q(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),K(),(async()=>{try{var e;const o=await p().get(`https://novacon.live/api/users?companyId=${null===M||void 0===M||null===(e=M.user)||void 0===e?void 0:e.companyId}&roleId=2`,{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const l=[];for(const e of null===o||void 0===o?void 0:o.data)l.push({value:null===e||void 0===e?void 0:e.id,label:`${null===e||void 0===e?void 0:e.firstName} ${null===e||void 0===e?void 0:e.lastName}`});S(l)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await p().get(`https://novacon.live/api/documents/mdr?companyId=${null===M||void 0===M||null===(e=M.user)||void 0===e?void 0:e.companyId}`,{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}}),l=[];for(const e of null===o||void 0===o?void 0:o.data)l.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});x(l)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e,o;const l=await p().get(`https://novacon.live/api/projects?companyId=${null===M||void 0===M||null===(e=M.user)||void 0===e?void 0:e.companyId}&roleId=${null===M||void 0===M||null===(o=M.user)||void 0===o?void 0:o.roleId}`,{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}}),t=[];for(const e of null===l||void 0===l?void 0:l.data)t.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});j(t)}catch(l){console.error("Error fetching departments:",null===l||void 0===l?void 0:l.message)}})()}),[]);const L=e=>{(async e=>{try{var o,l;const t=await p().get(`https://novacon.live/api/projects/fetchdocs?companyId=${null===M||void 0===M||null===(o=M.user)||void 0===o?void 0:o.companyId}&roleId=${null===M||void 0===M||null===(l=M.user)||void 0===l?void 0:l.roleId}&mdrId=${e}&departmentId=${null===M||void 0===M?void 0:M.user.departmentId}`,{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}});console.log(t.data,"response.data");const s=[];for(const e of null===t||void 0===t?void 0:t.data)s.push({value:null===e||void 0===e?void 0:e.title,label:null===e||void 0===e?void 0:e.title});console.log(s,"options"),k(s)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}})(e),$(e)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(i.A,{title:"Create Permissions",width:416,centered:!0,visible:l,onCancel:H,footer:null,closeIcon:(0,y.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,y.jsxs)(s.A,{layout:"vertical",name:"basic",form:N,onFinish:()=>{N.validateFields().then((e=>{(async()=>{try{var e,o;const l=await p().post("https://novacon.live/api/documents/permissions",{masterDocumentId:R,doc:P,userId:C,companyId:null===M||void 0===M||null===(e=M.user)||void 0===e?void 0:e.companyId,createDocument:null===G||void 0===G?void 0:G.includes("Creator"),reviewDocument:null===G||void 0===G?void 0:G.includes("Reviewer"),approveDocument:null===G||void 0===G?void 0:G.includes("Approver")},{headers:{Authorization:null===M||void 0===M?void 0:M.accessToken}});console.log(l),a.Ay.success(null===l||void 0===l||null===(o=l.data)||void 0===o?void 0:o.message),$(""),U(""),D(""),Q([]),K(),m(!1)}catch(l){"Request failed with status code 403"==(null===l||void 0===l?void 0:l.message)&&a.Ay.error("Permission Denied to create document on this MDR")}})(),N.resetFields()}))},children:[(0,y.jsx)(s.A.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,y.jsx)(n.A,{options:A,value:R,onChange:e=>L(e)})}),R&&(0,y.jsx)(s.A.Item,{label:"Doc",name:"doc",rules:[{required:!0,message:"Please select Doc"}],children:(0,y.jsx)(n.A,{options:w,value:P,onChange:e=>z(e)})}),(0,y.jsx)(s.A.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,y.jsx)(n.A,{options:b,value:C,onChange:e=>D(e)})}),(0,y.jsx)(s.A.Item,{label:"Permissions",name:"permissions",children:(0,y.jsx)(h.A.Group,{options:g,defaultValue:0,onChange:e=>{console.log("checked = ",e),Q(e)}})}),(0,y.jsxs)(d.A,{children:[(0,y.jsx)(r.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,y.jsx)(c.A,{block:!0,type:"primary",htmlType:"submit",children:"Add"})}),(0,y.jsx)(r.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,y.jsx)(c.A,{block:!0,onClick:H,children:"Cancel"})})]})]})}),(0,y.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,y.jsx)(c.A,{type:"primary",onClick:()=>{m(!0)},disabled:1!=(null===M||void 0===M||null===(o=M.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,y.jsx)(u.A,{columns:I,dataSource:_,bordered:!0,title:()=>"All Documents Permissions",footer:()=>"You may filter Documents"})]})}}}]);
//# sourceMappingURL=745.ca6e1e14.chunk.js.map
"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[2001],{23415:(e,t,l)=>{l.d(t,{A:()=>o});l(14556);var s=l(91688),a=l(70579);const o=()=>{var e;const t=null===(e=localStorage)||void 0===e?void 0:e.getItem("user");return console.log(t,"loggin"),t?null:(0,a.jsx)(s.Redirect,{to:"/pages/authentication/login"})}},92001:(e,t,l)=>{l.r(t),l.d(t,{default:()=>E});var s=l(65043),a=l(86904),o=l(94376),n=l(60521),i=l(64435),r=l(89421),d=l(83557),c=l(75932),u=l(15627),m=l(21261),p=l(79940),v=l(78186),h=l(26512),j=l(47419),x=l(11645),g=l(43886),A=l(73754),y=l(40854),f=l.n(y),I=l(91688),C=l(23415),k=l(62058),S=l(16854),b=l.n(S),D=l(7313),N=l(70579);const P=e=>{let{percentage:t}=e;return console.log("Percentage:",t),(0,N.jsx)(j.A,{justify:"center",align:"middle",style:{width:180},children:(0,N.jsx)(D.A,{percent:t,size:"small"})})};const w=(0,l(59662).A)((0,N.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Create");var z=l(45069),F=l(208);function E(){var e,t;const[l,y]=(0,s.useState)(""),[S,D]=(0,s.useState)(""),E=(0,s.useRef)(null),[$,V]=(0,s.useState)(),[q,O]=(0,s.useState)([]),[H,L]=(0,s.useState)(""),[M,B]=(0,s.useState)(!1),[Q,R]=(0,s.useState)(!1),[U,_]=(0,s.useState)(""),[G,J]=(0,s.useState)(""),[K,Y]=(0,s.useState)(""),[W,X]=(0,s.useState)(""),[Z,ee]=(0,s.useState)(""),[te,le]=(0,s.useState)([]),[se,ae]=(0,s.useState)(""),[oe,ne]=(0,s.useState)(""),[ie,re]=(0,s.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[de,ce]=(0,s.useState)([]),[ue,me]=(0,s.useState)([]),[pe,ve]=(0,s.useState)(!1),[he,je]=(0,s.useState)(null),[xe,ge]=a.A.useNotification(),[Ae]=o.A.useForm(),[ye,fe]=(0,s.useState)([]),[Ie,Ce]=(0,s.useState)([]),[ke,Se]=(0,s.useState)([]),[be,De]=(0,s.useState)([]),[Ne,Pe]=(0,s.useState)([]),[we]=o.A.useForm(),[ze,Fe]=(0,s.useState)(!1),[Ee,Te]=(0,s.useState)(),[$e,Ve]=(0,s.useState)(""),qe=(0,I.useHistory)(),[Oe]=o.A.useForm(),He=()=>{qe.push("./mdr")},Le=()=>{ve(!1)},Me=(e,t,l)=>{t(),y(e[0]),D(l)},Be=e=>({filterDropdown:t=>{let{setSelectedKeys:l,selectedKeys:s,confirm:a,clearFilters:o,close:d}=t;return(0,N.jsxs)("div",{style:{padding:8},children:[(0,N.jsx)(n.A,{ref:E,placeholder:`Search ${e}`,value:s[0],onChange:e=>l(e.target.value?[e.target.value]:[]),onPressEnter:()=>Me(s,a,e),style:{marginBottom:8,display:"block"}}),(0,N.jsxs)(i.A,{children:[(0,N.jsx)(r.A,{type:"primary",onClick:()=>Me(s,a,e),icon:(0,N.jsx)(k.A,{}),size:"small",style:{width:90},children:"Search"}),(0,N.jsx)(r.A,{onClick:()=>o&&(e=>{e(),y("")})(o),size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:e=>(0,N.jsx)(k.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(t,l)=>l[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=E.current)||void 0===e?void 0:e.select()}),100)},render:t=>S===e?(0,N.jsx)(b(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[l],autoEscape:!0,textToHighlight:t?t.toString():""}):t}),Qe=(d.A,d.A.Item,d.A.Item,d.A.Item,[{title:"Project Code",dataIndex:"code",key:"code",...Be("code")},{title:"Project ",dataIndex:"title",key:"title",...Be("title")},{title:"Department ",dataIndex:"departmentTitle",key:"departmentTitle",...Be("departmentTitle")},{title:"Client",dataIndex:"clientName",key:"clientName",...Be("clientName")},{title:"Start Date",dataIndex:"startedDate",key:"startedDate",sorter:(e,t)=>new Date(e.startedDate.split("/").reverse().join("/"))-new Date(t.startedDate.split("/").reverse().join("/"))},{title:"Expected End Date",dataIndex:"endedDate",key:"endedDate",sorter:(e,t)=>new Date(e.endedDate.split("/").reverse().join("/"))-new Date(t.endedDate.split("/").reverse().join("/"))},{title:"Status",key:"status",dataIndex:"status",filters:[{text:"Initialized",value:"Initialized"},{text:"Ongoing",value:"Ongoing"},{text:"Completed",value:"Completed"}],onFilter:(e,t)=>t.status===e},{title:"Progress",key:"percentage",render:(e,t)=>(0,N.jsx)(i.A,{children:null!==t.percentage?(0,N.jsx)(P,{percentage:t.percentage.toFixed(1)}):null})},{title:"Action",key:"action",render:(e,t)=>{var l,s,a;return(0,N.jsxs)(i.A,{size:"middle",children:[(0,N.jsx)(c.A,{title:"Create MDR",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(w,{}),disabled:1!==(null===ie||void 0===ie||null===(l=ie.user)||void 0===l?void 0:l.roleId),onClick:He})}),(0,N.jsx)(c.A,{title:"Update Project",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(F.A,{}),disabled:1!==(null===ie||void 0===ie||null===(s=ie.user)||void 0===s?void 0:s.roleId),onClick:()=>Ge(t)})}),(0,N.jsx)(c.A,{title:"Delete",children:(0,N.jsx)(r.A,{size:"middle",icon:(0,N.jsx)(z.A,{}),disabled:1!==(null===ie||void 0===ie||null===(a=ie.user)||void 0===a?void 0:a.roleId),onClick:()=>(e=>{je(e),ve(!0)})(t)})})]})}}]),Re=()=>{ne(""),ae(""),_(""),Y(""),L(""),le([]),B(!1)},Ue=async()=>{if(!U||!K)return void a.A.error({message:"Validation Error",description:"Please fill in all required fields.",style:{backgroundColor:"#f5222d",color:"#fff"}});const e=q.map((e=>{const t=Ie.find((t=>t.id===e));return{suffix:t?t.suffix:null,title:t?t.title:null}}));try{var t,l,s,o;const n=await f().post("https://novacon.live/api/projects/",{title:U,departmentId:q,departments:e,status:"Initialized",noOfUsers:0,clientId:K,code:oe,companyId:null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.companyId,authorId:null===ie||void 0===ie||null===(l=ie.user)||void 0===l?void 0:l.id,authorName:`${null===ie||void 0===ie||null===(s=ie.user)||void 0===s?void 0:s.firstName} ${null===ie||void 0===ie||null===(o=ie.user)||void 0===o?void 0:o.lastName}`,startedDate:W,endedDate:Z},{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log(n),B(!1),_e(),a.A.success({message:"Successfully Created",description:`${n.data.message}`,style:{backgroundColor:"#52c41a",color:"#fff"}})}catch(i){var n;409===(null===(n=i.response)||void 0===n?void 0:n.status)?a.A.error({message:"Conflict Error",description:"A project with this name or code already exists. Please choose a different name or code.",style:{backgroundColor:"#f5222d",color:"#fff"}}):a.A.error({message:"Error",description:"An error occurred while adding the project. Please try again.",style:{backgroundColor:"#f5222d",color:"#fff"}})}},_e=async()=>{try{var e,t;const l=await f().get(`https://novacon.live/api/projects?companyId=${null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId}&roleId=${null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.roleId}&id=${null===ie||void 0===ie?void 0:ie.user.id}&firstName=${null===ie||void 0===ie?void 0:ie.user.firstName}`,{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log("Project response data",l.data);const s=l.data.map((e=>{const t=new Date(e.startedDate).toLocaleDateString("en-GB"),l=new Date(e.endedDate).toLocaleDateString("en-GB");return console.log(e.clientId,"Yaha aya"),{...e,startedDate:t,endedDate:l}}));console.log("Project response data",s);const a=null===ie||void 0===ie?void 0:ie.user.departmentId;null===ie||void 0===ie||ie.user.roleId;console.log(a,"userId");const o=s.filter((e=>0==e.removed));ce(o),me(s);const n=[];for(const e of null===l||void 0===l?void 0:l.data)n.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});console.log(n),Se(n)}catch(l){console.error("Error fetching projects:",null===l||void 0===l?void 0:l.message)}},Ge=e=>{Te(e),Oe.setFieldsValue({id:e.id,title:e.title,code:e.code}),Fe(!0)},Je=()=>{Fe(!1)};(0,s.useEffect)((()=>{var e;re(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),(async()=>{try{var e;const l=await f().get(`https://novacon.live/api/clients?companyId=${null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId}`,{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}}),s=new Set,a={};var t=null===l||void 0===l?void 0:l.data.reduce(((e,t)=>(s.has(t.companyName)||(s.add(t.com),e.push({value:t.id,label:t.companyName,name:t.companyName}),a[t.id]=t.companyName),e)),[]);console.log(t,"options Aye hain"),console.log(a,"optionName Aye hain"),De(t),Pe(a)}catch(l){console.error("Error fetching departments:",null===l||void 0===l?void 0:l.message)}})(),(async()=>{try{var e;const t=await f().get(`https://novacon.live/api/departments?companyId=${null===ie||void 0===ie||null===(e=ie.user)||void 0===e?void 0:e.companyId}`,{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});console.log(t.data,"data agaya");const l=[],s=[];for(const e of null===t||void 0===t?void 0:t.data)l.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title}),s.push({id:null===e||void 0===e?void 0:e.id,title:null===e||void 0===e?void 0:e.title,suffix:null===e||void 0===e?void 0:e.suffix});Ce(s),fe(l)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}})(),_e()}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(m.A,{title:"Add Project",width:416,centered:!0,visible:M,onCancel:Re,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{layout:"vertical",name:"basic",onFinish:()=>{Ae.validateFields().then((e=>{Ue(),Ae.resetFields()}))},form:Ae,children:[(0,N.jsx)(o.A.Item,{label:"Project Code",name:"projCode",rules:[{required:!0,message:"Please Add Project Code"}],children:(0,N.jsx)(n.A,{value:G,onChange:e=>ne(e.target.value)})}),(0,N.jsx)(o.A.Item,{label:"Project Name",name:"projName",rules:[{required:!0,message:"Please Add Project Name"}],children:(0,N.jsx)(n.A,{value:U,onChange:e=>_(e.target.value)})}),(0,N.jsx)(o.A.Item,{label:"Client",name:"clientEmail",rules:[{required:!0,message:"Please select Client"}],children:(0,N.jsx)(p.A,{options:be,value:K,onChange:e=>Y(e)})}),(0,N.jsx)(o.A.Item,{label:"Departments",name:"departmentIds",rules:[{required:!0,message:"Please select at least one department"}],children:(0,N.jsx)(v.A.Group,{options:ye,value:q,onChange:O})}),(0,N.jsx)(o.A.Item,{label:"Start Date",name:"startedDate",rules:[{required:!0,message:"Please select start date"}],children:(0,N.jsx)(h.A,{style:{width:"100%"},onChange:e=>{X(e)}})}),(0,N.jsx)(o.A.Item,{label:"End Date",name:"endedDate",rules:[{required:!0,message:"Please select end date"}],children:(0,N.jsx)(h.A,{style:{width:"100%"},onChange:e=>{ee(e)}})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",children:"Add"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Re,children:"Cancel"})})]})]})}),(0,N.jsx)(m.A,{title:"Update Project",width:416,centered:!0,visible:ze,onCancel:Je,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{form:Oe,layout:"vertical",onFinish:async()=>{try{const e=await f().put(`https://novacon.live/api/projects?companyId=${null===ie||void 0===ie?void 0:ie.user.companyId}&id=${Oe.getFieldValue("id")}`,{title:Oe.getFieldValue("title"),code:Oe.getFieldValue("code")},{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});u.Ay.success(e.data.message),Je(),_e()}catch(e){console.error("Error updating departments:",null===e||void 0===e?void 0:e.message)}},children:[(0,N.jsx)(o.A.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Please enter the project title"}],children:(0,N.jsx)(n.A,{placeholder:"Enter Project title",onChange:e=>Oe.setFieldsValue({title:e.target.value})})}),(0,N.jsx)(o.A.Item,{label:"Project Code",name:"code",rules:[{required:!0,message:"Please enter Project code"}],children:(0,N.jsx)(n.A,{placeholder:"Enter Project code",onChange:e=>Oe.setFieldsValue({code:e.target.value})})}),(0,N.jsx)(o.A.Item,{children:(0,N.jsx)(r.A,{type:"primary",htmlType:"submit",block:!0,children:"Update"})})]})}),(0,N.jsxs)(m.A,{title:"Delete Project",width:416,centered:!0,visible:pe,onCancel:Le,footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:[(0,N.jsx)("div",{children:(0,N.jsx)("p",{children:"Are you sure you want to delete this?"})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",danger:!0,onClick:()=>(async e=>{const t=e.id;console.log(t);const l=await f().delete(`https://novacon.live/api/users?delete=3&recordId=${e.id}`,{headers:{Authorization:null===ie||void 0===ie?void 0:ie.accessToken}});u.Ay.success(l.data.message),Le(),_e()})(he),children:"Delete"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Le,children:"Cancel"})})]})]}),(0,N.jsx)(m.A,{title:"Document Permissions",width:416,centered:!0,visible:Q,onCancel:()=>{R(!1)},footer:null,closeIcon:(0,N.jsx)(A.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,N.jsxs)(o.A,{layout:"vertical",name:"basic",children:[(0,N.jsx)(o.A.Item,{label:"Project Name",name:"projectId",children:(0,N.jsx)(p.A,{options:ke,value:$e,onChange:e=>Ve(e)})}),(0,N.jsxs)(j.A,{children:[(0,N.jsx)(x.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,N.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>Ue(),children:"Add"})}),(0,N.jsx)(x.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,N.jsx)(r.A,{block:!0,onClick:Re,children:"Cancel"})})]})]})}),(0,N.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:1==(null===ie||void 0===ie||null===(t=ie.user)||void 0===t?void 0:t.roleId)&&(0,N.jsx)(r.A,{type:"primary",onClick:()=>{B(!0)},children:"Add Project"})}),(0,N.jsx)(g.A,{bordered:!0,size:"middle",title:()=>"All Project Details",footer:()=>"You may filter Projects",columns:Qe,dataSource:T(de)}),(0,N.jsx)(C.A,{})]})}const T=e=>{const t={};e.forEach((e=>{const l=e.title;t[l]?t[l].departmentNames.push(e.departmentName+","):t[l]={...e,departmentNames:[e.departmentName+","]}}));return Object.values(t).map((e=>({...e,departmentName:e.departmentNames.join("")})))}},45069:(e,t,l)=>{l.d(t,{A:()=>o});var s=l(59662),a=l(70579);const o=(0,s.A)((0,a.jsx)("path",{d:"M16 9v10H8V9zm-1.5-6h-5l-1 1H5v2h14V4h-3.5zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2z"}),"DeleteOutlined")}}]);
//# sourceMappingURL=2001.5daf223b.chunk.js.map
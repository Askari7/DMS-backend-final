"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[745],{10745:(e,o,t)=>{t.r(o),t.d(o,{default:()=>A});var l=t(65043),a=t(94376),s=t(15627),n=t(21261),d=t(70610),i=t(47419),r=t(11645),c=t(89421),u=t(43886),v=t(73754),m=t(40854),p=t.n(m),h=t(78186),y=t(70579);const I=[{title:"Project",dataIndex:"project",key:"project"},{title:"MDR ID",dataIndex:"masterDocumentId",key:"masterDocumentId"},{title:"User ID",dataIndex:"userId",key:"userId"},{title:"Reviewer",dataIndex:"allowReview",key:"allowReview"},{title:"Approver",dataIndex:"allowApprove",key:"allowApprove"},{title:"Uploader/Creator",dataIndex:"allowCreate",key:"allowCreate"}],g=[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}];function A(){var e,o;const[t,m]=(0,l.useState)(!1),[A,x]=(0,l.useState)([]),[f,j]=(0,l.useState)([]),[w,k]=(0,l.useState)([]),[b,S]=(0,l.useState)([]),[C,D]=(0,l.useState)(""),[R,P]=(0,l.useState)(""),[z,N]=(0,l.useState)(""),[T]=a.A.useForm(),[U,E]=(0,l.useState)(""),[F,M]=(0,l.useState)(!1),[q,_]=(0,l.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[J,O]=(0,l.useState)([]),[B,G]=(0,l.useState)([]),[Q,V]=(0,l.useState)([]),[Y,H]=(0,l.useState)(""),K=()=>{P(""),E(""),m(!1)},L=async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/documents/permissions?companyId=".concat(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}});console.log(o.data),O(o.data)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}};(0,l.useEffect)((()=>{var e;_(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),L(),(async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/users?companyId=".concat(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.companyId,"&roleId=2"),{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)});S(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await p().get("http://127.0.0.1:8083/api/documents/mdr?companyId=".concat(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}}),t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});x(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e,o;const t=await p().get("http://127.0.0.1:8083/api/projects?companyId=".concat(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.companyId,"&roleId=").concat(null===q||void 0===q||null===(o=q.user)||void 0===o?void 0:o.roleId),{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}}),l=[];for(const e of null===t||void 0===t?void 0:t.data)l.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title});j(l)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}})()}),[]);const W=e=>{(async e=>{try{var o,t;const l=await p().get("http://127.0.0.1:8083/api/projects/fetchdocs?companyId=".concat(null===q||void 0===q||null===(o=q.user)||void 0===o?void 0:o.companyId,"&roleId=").concat(null===q||void 0===q||null===(t=q.user)||void 0===t?void 0:t.roleId,"&mdrId=").concat(e,"&departmentId=").concat(null===q||void 0===q?void 0:q.user.departmentId),{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}});console.log(l.data,"response.data");const a=[];for(const e of null===l||void 0===l?void 0:l.data)a.push({value:null===e||void 0===e?void 0:e.title,label:null===e||void 0===e?void 0:e.title});console.log(a,"options"),k(a)}catch(l){console.error("Error fetching departments:",null===l||void 0===l?void 0:l.message)}})(e),P(e)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(n.A,{title:"Create Permissions",width:416,centered:!0,visible:t,onCancel:K,footer:null,closeIcon:(0,y.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,y.jsxs)(a.A,{layout:"vertical",name:"basic",form:T,onFinish:()=>{T.validateFields().then((e=>{(async()=>{try{var e,o;const t=await p().post("http://127.0.0.1:8083/api/documents/permissions",{masterDocumentId:R,doc:z,userId:C,companyId:null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.companyId,createDocument:null===Q||void 0===Q?void 0:Q.includes("Creator"),reviewDocument:null===Q||void 0===Q?void 0:Q.includes("Reviewer"),approveDocument:null===Q||void 0===Q?void 0:Q.includes("Approver")},{headers:{Authorization:null===q||void 0===q?void 0:q.accessToken}});console.log(t),s.Ay.success(null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message),P(""),E(""),D(""),V([]),L(),m(!1)}catch(t){"Request failed with status code 403"==(null===t||void 0===t?void 0:t.message)&&s.Ay.error("Permission Denied to create document on this MDR")}})(),T.resetFields()}))},children:[(0,y.jsx)(a.A.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,y.jsx)(d.A,{options:A,value:R,onChange:e=>W(e)})}),R&&(0,y.jsx)(a.A.Item,{label:"Doc",name:"doc",rules:[{required:!0,message:"Please select Doc"}],children:(0,y.jsx)(d.A,{options:w,value:z,onChange:e=>N(e)})}),(0,y.jsx)(a.A.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,y.jsx)(d.A,{options:b,value:C,onChange:e=>D(e)})}),(0,y.jsx)(a.A.Item,{label:"Permissions",name:"permissions",children:(0,y.jsx)(h.A.Group,{options:g,defaultValue:0,onChange:e=>{console.log("checked = ",e),V(e)}})}),(0,y.jsxs)(i.A,{children:[(0,y.jsx)(r.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,y.jsx)(c.A,{block:!0,type:"primary",htmlType:"submit",children:"Add"})}),(0,y.jsx)(r.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,y.jsx)(c.A,{block:!0,onClick:K,children:"Cancel"})})]})]})}),(0,y.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,y.jsx)(c.A,{type:"primary",onClick:()=>{m(!0)},disabled:1!=(null===q||void 0===q||null===(o=q.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,y.jsx)(u.A,{columns:I,dataSource:J,bordered:!0,title:()=>"All Documents Permissions",footer:()=>"You may filter Documents"})]})}}}]);
//# sourceMappingURL=745.82057a3c.chunk.js.map
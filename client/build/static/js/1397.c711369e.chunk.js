"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[1397],{1397:(e,o,t)=>{t.r(o),t.d(o,{default:()=>V});var n=t(65043),s=t(60521),a=t(64435),r=t(89421),c=t(15627),i=t(21261),l=t(47419),d=t(11645),u=t(94376),m=t(70610),p=t(26412),v=t(22285),h=t(40854),y=t.n(h),g=t(78186),x=t(62058),f=t(16854),A=t.n(f),j=t(91688),S=t(39816),w=t(58168),b=t(64467),I=t(98139),C=t.n(I),k=t(40164),N=t(25055),O=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)o.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]])}return t};const R=function(e){var o,t,s=e.prefixCls,a=e.className,r=e.color,c=void 0===r?"blue":r,i=e.dot,l=e.pending,d=void 0!==l&&l,u=(e.position,e.label),m=e.children,p=O(e,["prefixCls","className","color","dot","pending","position","label","children"]),v=(0,n.useContext(N.QO).getPrefixCls)("timeline",s),h=C()((o={},(0,b.A)(o,"".concat(v,"-item"),!0),(0,b.A)(o,"".concat(v,"-item-pending"),d),o),a),y=C()((t={},(0,b.A)(t,"".concat(v,"-item-head"),!0),(0,b.A)(t,"".concat(v,"-item-head-custom"),!!i),(0,b.A)(t,"".concat(v,"-item-head-").concat(c),!0),t));return n.createElement("li",(0,w.A)({},p,{className:h}),u&&n.createElement("div",{className:"".concat(v,"-item-label")},u),n.createElement("div",{className:"".concat(v,"-item-tail")}),n.createElement("div",{className:y,style:{borderColor:/blue|red|green|gray/.test(c||"")?void 0:c}},i),n.createElement("div",{className:"".concat(v,"-item-content")},m))};var E=t(12701),D=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)o.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]])}return t},P=function(e){var o,t=n.useContext(N.QO),s=t.getPrefixCls,a=t.direction,r=e.prefixCls,c=e.pending,i=void 0===c?null:c,l=e.pendingDot,d=e.children,u=e.className,m=e.reverse,p=void 0!==m&&m,v=e.mode,h=void 0===v?"":v,y=D(e,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),g=s("timeline",r),x="boolean"===typeof i?null:i,f=i?n.createElement(R,{pending:!!i,dot:l||n.createElement(k.A,null)},x):null,A=n.Children.toArray(d);A.push(f),p&&A.reverse();var j=function(e,o){return"alternate"===h?"right"===e.props.position?"".concat(g,"-item-right"):"left"===e.props.position?"".concat(g,"-item-left"):"".concat(g,o%2===0?"-item-left":"-item-right"):"left"===h?"".concat(g,"-item-left"):"right"===h||"right"===e.props.position?"".concat(g,"-item-right"):""},S=A.filter((function(e){return!!e})),I=n.Children.count(S),O="".concat(g,"-item-last"),P=n.Children.map(S,(function(e,o){var t=o===I-2?O:"",n=o===I-1?O:"";return(0,E.Ob)(e,{className:C()([e.props.className,!p&&i?t:n,j(e,o)])})})),T=A.some((function(e){var o;return!!(null===(o=null===e||void 0===e?void 0:e.props)||void 0===o?void 0:o.label)})),z=C()(g,(o={},(0,b.A)(o,"".concat(g,"-pending"),!!i),(0,b.A)(o,"".concat(g,"-reverse"),!!p),(0,b.A)(o,"".concat(g,"-").concat(h),!!h&&!T),(0,b.A)(o,"".concat(g,"-label"),T),(0,b.A)(o,"".concat(g,"-rtl"),"rtl"===a),o),u);return n.createElement("ul",(0,w.A)({},y,{className:z}),P)};P.Item=R;const T=P;var z=t(70579);function B(e){let{data:o,thisOne:t,user:n}=e;const s=t?{[t]:o[t]}:{};return(0,z.jsx)(S.A,{style:{justifyContent:"center",alignItems:"center",border:"5px solid #e8e8e8",borderRadius:"10px",padding:"32px",marginBottom:"20px"},children:(0,z.jsx)(l.A,{children:(0,z.jsxs)(d.A,{span:32,children:[(0,z.jsx)("h5",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"10px"},children:"Document History"}),(0,z.jsx)(T,{style:{marginTop:"20px"},children:Object.entries(s).map((e=>{let[o,t]=e;return(0,z.jsxs)(T.Item,{children:[(0,z.jsx)("h4",{style:{fontSize:"16px",marginBottom:"10px"},children:o}),(0,z.jsx)(T,{children:t.map(((e,t)=>(0,z.jsxs)(T.Item,{style:{borderLeft:"2px solid #1890ff",paddingLeft:"10px",marginBottom:"10px"},children:[(0,z.jsxs)("p",{children:["Version: ",e.version]}),(0,z.jsxs)("p",{children:[(0,z.jsx)("span",{style:{color:"black"},children:new Date(e.createdAt).toLocaleDateString()})," ",(0,z.jsx)("span",{style:{color:"blue"},children:new Date(e.createdAt).toLocaleTimeString()})]}),e.reviewerComment&&(0,z.jsxs)("p",{style:{marginBottom:"5px",color:"#666"},children:["Reviewer Comments: ",e.reviewerComment]}),e.approverComment&&(0,z.jsxs)("p",{style:{marginBottom:"5px",color:"#666"},children:["Approver Comments: ",e.approverComment]}),(0,z.jsx)(r.A,{type:"primary",style:{marginTop:"10px"},onClick:()=>((e,o)=>{const{version:t}=e,{roleId:s,firstName:a}=n.user,r="".concat("http://54.81.250.98:8083","/uploads/").concat(o,"-").concat(t,".pdf");window.location.href="http://54.81.250.98:3001/react-pdf-highlighter/?docName=".concat(o,".pdf&url=").concat(r,"&allowed=").concat(!0,"&user=").concat(s," ").concat(a)})(e,o),children:"Open"})]},"".concat(o,"-").concat(t))))})]},o)}))})]})})})}t(14556);t.p;t.p;function V(){var e,o;(0,j.useHistory)();const[t,h]=(0,n.useState)(""),[f,S]=(0,n.useState)(""),w=(0,n.useRef)(null),b=(e,o,t)=>{o(),h(e[0]),S(t)},I=e=>({filterDropdown:o=>{let{setSelectedKeys:t,selectedKeys:n,confirm:c,clearFilters:i,close:l}=o;return(0,z.jsxs)("div",{style:{padding:8},children:[(0,z.jsx)(s.A,{ref:w,placeholder:"Search ".concat(e),value:n[0],onChange:e=>t(e.target.value?[e.target.value]:[]),onPressEnter:()=>b(n,c,e),style:{marginBottom:8,display:"block"}}),(0,z.jsxs)(a.A,{children:[(0,z.jsx)(r.A,{type:"primary",onClick:()=>b(n,c,e),icon:(0,z.jsx)(x.A,{}),size:"small",style:{width:90},children:"Search"}),(0,z.jsx)(r.A,{onClick:()=>i&&(e=>{e(),h("")})(i),size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:e=>(0,z.jsx)(x.A,{style:{color:e?"#1677ff":void 0}}),onFilter:(o,t)=>t[e].toString().toLowerCase().includes(o.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout((()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.select()}),100)},render:o=>f===e?(0,z.jsx)(A(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[t],autoEscape:!0,textToHighlight:o?o.toString():""}):o}),C="http://54.81.250.98:8083",k=[{title:"Document Name",dataIndex:"docName",key:"docName",...I("docName")},{title:"MDR Code",dataIndex:"masterDocumentCode",key:"masterDocumentCode",...I("masterDocumentCode")},{title:"Approver",dataIndex:"approver",key:"approver",...I("approver")},{title:"Reviewer",dataIndex:"reviewer",key:"reviewer",...I("reviewer")},{title:"Your Role",dataIndex:"yourRole",key:"yourRole"},{title:"Your Status",dataIndex:"yourStatus",key:"yourStatus"},{title:"Overall Approver Status",dataIndex:"approverStatuss",key:"approverStatuss"},{title:"Overall Reviewer Status",dataIndex:"reviewerStatuss",key:"reviewerStatuss"},{title:"Version",dataIndex:"version",key:"version"},{title:"Action",key:"action",render:(e,o)=>(0,z.jsxs)(a.A,{size:"middle",children:[(0,z.jsx)("a",{onClick:()=>no(o),children:"Open"}),(0,z.jsx)("a",{onClick:()=>Qe(o),children:"Add Status"}),(0,z.jsx)("a",{onClick:()=>He(o),children:"Send to Client"}),(0,z.jsx)("a",{onClick:()=>Ye(o),children:"Show Doc History"}),(0,z.jsx)("a",{onClick:()=>Ke(o),children:"Export Comments"})]})}],N=[{title:"Document Name",dataIndex:"docName",key:"docName",...I("docName")},{title:"Your Role",dataIndex:"yourRole",key:"yourRole"},{title:"Your Status",dataIndex:"clientStatus",key:"clientStatus"},{title:"Version",dataIndex:"version",key:"version"},{title:"Action",key:"action",render:(e,o)=>(0,z.jsxs)(a.A,{size:"middle",children:[(0,z.jsx)("a",{onClick:()=>no(o),children:"Open"}),(0,z.jsx)("a",{onClick:()=>Qe(o),children:"Add Status"})]})}],[O,R]=(0,n.useState)(""),[E,D]=(0,n.useState)(""),[P,T]=(0,n.useState)(null),[V,U]=(0,n.useState)(!1),[L,J]=(0,n.useState)(!1),[q,F]=(0,n.useState)([]),[Q,M]=(0,n.useState)(),[Y,H]=(0,n.useState)(!1),[W,_]=(0,n.useState)(!1),[K,G]=(0,n.useState)([]),[X,Z]=(0,n.useState)([]),[$,ee]=(0,n.useState)(""),[oe,te]=(0,n.useState)([]),[ne,se]=(0,n.useState)(""),[ae,re]=(0,n.useState)(!1),[ce,ie]=(0,n.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[le,de]=(0,n.useState)([]),[ue,me]=(0,n.useState)([]),[pe,ve]=(0,n.useState)([]),[he,ye]=(0,n.useState)([]),[ge,xe]=(0,n.useState)([]),[fe,Ae]=(0,n.useState)([]),[je,Se]=(0,n.useState)([]),[we,be]=(0,n.useState)([]),[Ie,Ce]=(0,n.useState)(),[ke,Ne]=(0,n.useState)(),[Oe,Re]=(0,n.useState)([]),[Ee,De]=(0,n.useState)([]),[Pe,Te]=(0,n.useState)([]),[ze,Be]=(0,n.useState)([]),[Ve,Ue]=(0,n.useState)(!1),[Le,Je]=(0,n.useState)(""),[qe,Fe]=(0,n.useState)(""),Qe=e=>{T(e),U(!0)},Me=()=>{R(""),U(!1)},Ye=e=>{Fe(e.docName),H(!0)},He=e=>{console.log(e,"record");const o=JSON.stringify(e);console.log(o,"record"),M(o),oo(),J(!0)},We=()=>{J(!1)},_e=async e=>{console.log(e,"record dekhS");e.clientId;const o=E||"",t=e.version,n=e.id,s=ze.find((e=>e.id===n)),a=Pe.find((e=>e.id===n)),r=s.status,i=a.status;console.log(r,i,"REVIEWAPPROVE"),console.log(r,i,"ids");const l=we.find((e=>e.id===n)),d=je.find((e=>e.id===n));try{if(E){const n=await y().put("http://54.81.250.98:8083/api/documents/review?yourRole=".concat("client","&myrecord=",e,"\n          &version=").concat(e.version,"&userName=").concat(e.userName,"\n          &companyId=").concat(e.companyId,"&rev=").concat(s,"&app=").concat(a,"\n          "),{version:t,clientStatus:"Reject",clientComment:o,docName:e.docName,rev:l,app:d,myrecord:e},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(n.data,"data aya"),c.Ay.success(n.data.message)}else{const o=await y().put("http://54.81.250.98:8083/api/documents/review?yourRole=".concat("client","&record=",Q,"&rev=").concat(s,"&app=").concat(a),{version:t,clientStatus:"Accept",myrecord:e,docName:e.docName},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});c.Ay.success(o.data.message),console.log(o.data,"data aya")}await ao()}catch(u){console.error(u)}},Ke=async(e,o)=>{if(await Xe(e),console.log(oe,"comments"),oe.length>0){const e=Ge(oe),o=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(o),n=document.createElement("a");n.href=t,n.setAttribute("download","Comments for ".concat(oe[0].docName,".csv")),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},Ge=e=>{const o=[],t=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce(((n,s)=>{const a=o?"".concat(o,".").concat(s):s;if("object"!==typeof e[s]||Array.isArray(e[s])||null===e[s])return{...n,[a]:e[s]};{const o=t(e[s],a);return{...n,...o}}}),{})},n=e.map((e=>t(e))),s=n.reduce(((e,o)=>[...e,...Object.keys(o)]),[]),a=[...new Set(s)].sort();return o.push('"'.concat(a.join('","'),'"')),n.forEach((e=>{const t=a.map((o=>{const t=e[o];return Array.isArray(t)?'"'.concat(t.map((e=>Object.values(e).join(","))).join(";"),'"'):'"'.concat("object"===typeof t&&null!==t?JSON.stringify(t):t,'"')}));o.push(t.join(","))})),o.join("\n")},Xe=async e=>{try{const o=await y().get("http://54.81.250.98:8083/api/documents/exportComments?docName=".concat(e.docName,"&version=").concat(e.version),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(o.data,"data");o.data;const t=o.data.map((e=>{const{id:o,updatedAt:t,comment:n,emoji:s,...a}=e;return a}));console.log(t,"datawithout"),te(t)}catch(o){console.error("Error fetching documents:",null===o||void 0===o?void 0:o.message)}},Ze=async e=>{console.log("rejection",E),console.log(e,"status bhi aya"),P&&(console.log(P,"document"),console.log(e,"status"),console.log(ze,Pe,"ye bhi dekh"),console.log(we,je,"ye bhi"),6==ce.user.roleId?await _e(P):await ro(P),Me())},[$e,eo]=(0,n.useState)(""),oo=async()=>{try{var e;console.log(Q,"coddd");const o=await y().get("http://54.81.250.98:8083/api/clients?companyId=".concat(null===ce||void 0===ce||null===(e=ce.user)||void 0===e?void 0:e.companyId,"&recordId=").concat(Q),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(o.data,"received");const t=o.data.map((e=>({value:e.Email,label:e.Email})));console.log("clients",t),ve(t)}catch(o){console.error("Error fetching clients:",null===o||void 0===o?void 0:o.message)}},to=async e=>{try{var o;const t=await y().get("http://54.81.250.98:8083/api/documents/establishment?companyId=".concat(null===ce||void 0===ce||null===(o=ce.user)||void 0===o?void 0:o.companyId,"&userId=").concat(ce.user.id,"&docName=").concat(e),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});return console.log(t.data,"received"),t.data}catch(t){console.error("Error fetching documents:",null===t||void 0===t?void 0:t.message)}},no=async e=>{const o=await to(e.docName);console.log("helllooo",o);const t=e.docName,n="".concat(C,"/uploads/").concat(t,"-").concat(e.version,".pdf");console.log(ce.user.roleId,ce.user.firstName,ce);let s="false";o&&(s="true"),window.location.href="http://54.81.250.98:3001/react-pdf-highlighter/?docName=".concat(t,".pdf&url=").concat(n,"&allowed=").concat(s,"&user=").concat(ce.user.roleId," ").concat(ce.user.firstName)},so=()=>{se(""),_(!1)},ao=async()=>{try{var e,o;const t=await y().get("http://54.81.250.98:8083/api/documents/establishment?companyId=".concat(null===ce||void 0===ce||null===(e=ce.user)||void 0===e?void 0:e.companyId,"&userId=").concat(null===ce||void 0===ce||null===(o=ce.user)||void 0===o?void 0:o.id,"&roleId=").concat(ce.user.roleId),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log("response",t.data);const n=[],s=[],a=[],r=[];for(let e of t.data){console.log(e,"response.data",e.id);const o=e.approverStatus.split(",").map((e=>parseInt(e.trim(),10)));console.log(o,"AppStatusArray");const t=e.reviewerStatus.split(",").map((e=>parseInt(e.trim(),10)));console.log(t,"RevStatusArray");const c=e.reviewerId.split(",").map((e=>parseInt(e.trim(),10))),i=e.approverId.split(",").map((e=>parseInt(e.trim(),10)));console.log(c,i,"ID Arrays");const l=e.approverComment.split(","),d=e.reviewerComment.split(",");console.log(l,d,"Comments"),n.push({id:e.id,status:o,comment:l}),s.push({id:e.id,status:t,comment:d}),a.push({id:e.id,status:c}),r.push({id:e.id,status:i}),Be(a),Te(r),be(s),Se(n),e.approverId.includes(ce.user.id)&&e.reviewerId.includes(ce.user.id)?(e.yourRole="Approver and Reviewer",1==o[i.indexOf(ce.user.id)]?e.yourStatus="Rejected":2==o[i.indexOf(ce.user.id)]?e.yourStatus="Accepted":0==o[i.indexOf(ce.user.id)]&&(e.yourStatus="Pending")):i.includes(ce.user.id)?(console.log(i.includes(ce.user.id),"approver ha"),e.yourRole="Approver",Je(i.indexOf(ce.user.id)),console.log(i.indexOf(ce.user.id),"jjjjj"),console.log(i,ce.user.id,o[i.indexOf(ce.user.id)],"ssss"+typeof o),1==o[i.indexOf(ce.user.id)]?e.yourStatus="Rejected":2==o[i.indexOf(ce.user.id)]?e.yourStatus="Accepted":0==o[i.indexOf(ce.user.id)]&&(e.yourStatus="Pending")):c.includes(ce.user.id)?(console.log(c.includes(ce.user.id),"reviewer ha"),e.yourRole="Reviewer",Je(c.indexOf(ce.user.id)),console.log(c.indexOf(ce.user.id),"jjjjj"),console.log(c,ce.user.id,t[c.indexOf(ce.user.id)],"ssss"+typeof t),1==t[c.indexOf(ce.user.id)]?e.yourStatus="Rejected":2==t[c.indexOf(ce.user.id)]?e.yourStatus="Accepted":0==t[c.indexOf(ce.user.id)]&&(e.yourStatus="Pending")):e.yourRole="Client",o.every((e=>0===e))?e.approverStatuss="Pending":o.some((e=>0!==e&&2!==e))?e.approverStatuss="Rejected":o.every((e=>2===e))?e.approverStatuss="Sent to Client":e.approverStatuss="Pending",t.every((e=>0===e))?e.reviewerStatuss="Pending":t.every((e=>1===e))?e.reviewerStatuss="Rejected":t.every((e=>2===e))?e.reviewerStatuss="Sent for Approval":e.reviewerStatuss="Pending"}console.log(n,s,a,r,"arrays hain ye "),de(t.data)}catch(t){console.error("Error fetching departments:",null===t||void 0===t?void 0:t.message)}},ro=async e=>{console.log(e,"record dekhS");const o=e.id,t=ze.find((e=>e.id===o)),n=Pe.find((e=>e.id===o));console.log(t,n,"APPREV");const s=t.status,a=n.status;console.log(s,a,"REVIEWAPPROVE"),console.log(s,a,"ids");const r=we.find((e=>e.id===o)),i=je.find((e=>e.id===o));console.log(r,i,"STATUS OBJ");const l=r.status,d=i.status;console.log(l,d,"STATUS FOR ");const u=r.comment,m=i.comment;if(console.log(u,m,"COmment For"),console.log(d,l,"obj"),"Approver and Reviewer"===e.yourRole&&"Accept"===O)d[a.indexOf(ce.user.id)]=2,l[s.indexOf(ce.user.id)]=2;else if("Approver and Reviewer"===e.yourRole&&"Reject"===O){d[a.indexOf(ce.user.id)]=1,l[s.indexOf(ce.user.id)]=1;const e=a.indexOf(ce.user.id),o=s.indexOf(ce.user.id);m[e]=E,u[o]=E}else if("Approver"===e.yourRole&&"Accept"===O)d[a.indexOf(ce.user.id)]=2;else if("Reviewer"===e.yourRole&&"Accept"===O)l[s.indexOf(ce.user.id)]=2;else if("Approver"===e.yourRole&&"Reject"===O){d[a.indexOf(ce.user.id)]=1;m[a.indexOf(ce.user.id)]=E}else if("Reviewer"===e.yourRole&&"Reject"===O){l[s.indexOf(ce.user.id)]=1;u[s.indexOf(ce.user.id)]=E}console.log(l,"changed Rev"),console.log(d,"changed App"),Ne(l),Ce(d);const p=JSON.stringify(e);console.log(p,"record bhej rha hun");try{if(E){const o=await y().put("http://54.81.250.98:8083/api/documents/establishment?yourRole=".concat(e.yourRole,"\n          &version=").concat(e.version,"&userName=").concat(e.userName,"&approver=").concat(e.approver,"&reviewer=").concat(e.reviewer,"\n          &reviewerId=").concat(e.reviewerId,"&approverId=").concat(e.approverId,"\n          &docDepartmentId=").concat(e.docDepartmentId,"&masterDocumentCode=").concat(e.masterDocumentCode,"&masterDocumentName=").concat(e.masterDocumentName,"\n          &companyId=").concat(e.companyId,"\n\n          "),{revStatusArr:l.join(","),appStatusArr:d.join(","),reviewerComment:u.join(","),approverComment:m.join(","),docName:e.docName},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(o.data,"data aya"),c.Ay.success(o.data.message)}else{const o=await y().post("http://54.81.250.98:8083/api/documents/review?yourRole=".concat(e.yourRole,"&version=").concat(e.version),{revStatusArr:l.join(","),appStatusArr:d.join(","),docName:e.docName},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});c.Ay.success(o.data.message),console.log(o.data,"data aya")}R(""),await ao()}catch(v){console.error(v)}};return(0,n.useEffect)((async()=>{var e;ie(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),await ao(),(async()=>{try{var e;const o=await y().get("http://54.81.250.98:8083/api/users?companyId=".concat(null===ce||void 0===ce||null===(e=ce.user)||void 0===e?void 0:e.companyId,"&roleId=2"),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)});Z(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await y().get("http://54.81.250.98:8083/api/documents/mdr?companyId=".concat(null===ce||void 0===ce||null===(e=ce.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}}),t=[];for(const e of null===o||void 0===o?void 0:o.data)t.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title,DocumentPermissionId:null===e||void 0===e?void 0:e.DocumentPermissionId,departmentId:null===e||void 0===e?void 0:e.departmentId});G(t)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{const e=await y().post("http://54.81.250.98:8083/api/documents/establishment",{companyId:null===ce||void 0===ce?void 0:ce.user.companyId},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});me(e.data);const o=e=>{const o={};return e.forEach((e=>{const{docName:t,version:n,createdAt:s,reviewerComment:a,approverComment:r}=e;o[t]||(o[t]=[]),o[t].push({version:n,createdAt:s,reviewerComment:a,approverComment:r})})),o},t=o(e.data);console.log(t,"organizedData"),me(t)}catch(e){console.error(e)}})()}),[]),(0,n.useEffect)((async()=>{await oo()}),[Q]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(i.A,{title:"Change Status",width:400,centered:!0,visible:V,onCancel:Me,footer:null,closeIcon:(0,z.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,z.jsx)(l.A,{justify:"space-between",align:"center",children:(0,z.jsx)(d.A,{span:20,children:(0,z.jsxs)(u.A,{layout:"vertical",name:"basic",children:[(0,z.jsx)(u.A.Item,{label:"Select Status",name:"selectedStatus",rules:[{required:!0,message:"Please select a status"}],children:(0,z.jsx)(m.A,{options:[{label:"Accept",value:"Accept"},{label:"Reject",value:"Reject"}],value:O,onChange:e=>{return R(o=e),void Ue("Reject"===o);var o}})}),Ve&&(0,z.jsx)(u.A.Item,{label:"Remarks",name:"remarks",rules:[{required:!0,message:"Please provide remarks for rejection"}],children:(0,z.jsx)(s.A.TextArea,{rows:4,placeholder:"Enter remarks for rejection",value:E,onChange:e=>D(e.target.value)})}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(d.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,z.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>Ze(O),children:"Submit"})}),(0,z.jsx)(d.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,z.jsx)(r.A,{block:!0,onClick:Me,children:"Cancel"})})]})]})})})}),(0,z.jsx)(i.A,{title:"Timeline",width:400,centered:!0,visible:Y,onCancel:()=>{H(!1)},footer:null,closeIcon:(0,z.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,z.jsx)(l.A,{justify:"space-between",align:"center",children:(0,z.jsx)(d.A,{span:20,children:(0,z.jsx)(B,{data:ue,thisOne:qe,user:ce})})})}),(0,z.jsx)(i.A,{title:"Send To Client",width:400,centered:!0,visible:L,onCancel:We,footer:null,closeIcon:(0,z.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,z.jsx)(l.A,{justify:"space-between",align:"center",children:(0,z.jsx)(d.A,{span:20,children:(0,z.jsxs)(u.A,{layout:"vertical",name:"basic",children:[(0,z.jsx)(u.A.Item,{label:"Select Emails",name:"selectedEmails",rules:[{required:!0,message:"Please select a Email"}],children:(0,z.jsx)(m.A,{options:pe,value:q,onChange:e=>F(e)})}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(d.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,z.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{const e=JSON.parse(Q);console.log("Record:",e.docName);const o=await to(e.docName);console.log("helllooo",o);const t=e.docName,n=e.version,s="".concat(C,"/uploads/").concat(t,"-").concat(e.version,".pdf");console.log(ce.user.roleId,ce.user.firstName,ce);let a="false";o&&(a="true");const r="http://54.81.250.98:3001/react-pdf-highlighter/?docName=".concat(t,".pdf&url=").concat(s,"&allowed=").concat(a,"&user=").concat(ce.user.roleId," ").concat(ce.user.firstName);try{var i,l;const o=await y().post("http://54.81.250.98:8083/api/clients/send-email-client",{parsedRecord:e,docVersion:n,docName:t,roleId:ce.user.roleId,companyId:null===ce||void 0===ce||null===(i=ce.user)||void 0===i?void 0:i.companyId,url:r,clientName:q},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(o),c.Ay.success(null===o||void 0===o||null===(l=o.data)||void 0===l?void 0:l.message)}catch(d){console.error("Error Sending Email:",null===d||void 0===d?void 0:d.message)}})(),children:"Send"})}),(0,z.jsx)(d.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,z.jsx)(r.A,{block:!0,onClick:We,children:"Cancel"})})]})]})})})}),(0,z.jsx)(i.A,{title:"Create Permissions",width:416,centered:!0,visible:W,onCancel:so,footer:null,closeIcon:(0,z.jsx)(v.dCQ,{className:"remix-icon text-color-black-100",size:24}),children:(0,z.jsxs)(u.A,{layout:"vertical",name:"basic",children:[(0,z.jsx)(u.A.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,z.jsx)(m.A,{options:K,value:ne,onChange:e=>se(e)})}),(0,z.jsx)(u.A.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,z.jsx)(m.A,{options:X,value:$,onChange:e=>ee(e)})}),(0,z.jsx)(u.A.Item,{label:"Permissions",name:"permissions",children:(0,z.jsx)(g.A.Group,{options:[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}],defaultValue:0,onChange:e=>{console.log("checked = ",e),xe(e)}})}),(0,z.jsxs)(l.A,{children:[(0,z.jsx)(d.A,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,z.jsx)(r.A,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{try{var e,o;const t=await y().post("http://54.81.250.98:8083/api/documents/permissions",{masterDocumentId:ne,userId:$,companyId:null===ce||void 0===ce||null===(e=ce.user)||void 0===e?void 0:e.companyId,createDocument:null===ge||void 0===ge?void 0:ge.includes("Creator"),reviewDocument:null===ge||void 0===ge?void 0:ge.includes("Reviewer"),approveDocument:null===ge||void 0===ge?void 0:ge.includes("Approver")},{headers:{Authorization:null===ce||void 0===ce?void 0:ce.accessToken}});console.log(t),c.Ay.success(null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.message),se(""),ee(""),xe([]),await ao(),_(!1)}catch(t){"Request failed with status code 403"==(null===t||void 0===t?void 0:t.message)&&c.Ay.error("Permission Denied to create document on this MDR")}})(),children:"Add"})}),(0,z.jsx)(d.A,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,z.jsx)(r.A,{block:!0,onClick:so,children:"Cancel"})})]})]})}),(0,z.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,z.jsx)(r.A,{type:"primary",onClick:()=>{_(!0)},disabled:1!=(null===ce||void 0===ce||null===(o=ce.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,z.jsx)("div",{style:{overflowX:"auto"},children:(0,z.jsx)(p.A,{columns:6==ce.user.roleId?N:k,dataSource:le,bordered:!0,size:"middle",title:()=>"All Documents Assessments",footer:()=>"You may filter Documents"})})]})}}}]);
//# sourceMappingURL=1397.c711369e.chunk.js.map
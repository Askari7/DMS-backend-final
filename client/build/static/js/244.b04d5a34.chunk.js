"use strict";(self.webpackChunkyoda_admin_react=self.webpackChunkyoda_admin_react||[]).push([[244],{28244:(e,o,a)=>{a.r(o),a.d(o,{default:()=>g});var t=a(69060),l=a(26701),s=a(39322),i=a(38088),n=a(80336),d=a(57156),r=a(29512),c=a(74421),u=a(19056),v=a(38112),m=a(26536),p=a.n(m),h=a(48004),I=a(82496);const y=[{title:"ID",dataIndex:"id",key:"id"},{title:"MDR ID",dataIndex:"masterDocumentId",key:"masterDocumentId"},{title:"User ID",dataIndex:"userId",key:"userId"},{title:"Reviewer",dataIndex:"allowReview",key:"allowReview"},{title:"Approver",dataIndex:"allowApprove",key:"allowApprove"},{title:"Creator",dataIndex:"allowCreate",key:"allowCreate"}],x=[{label:"Reviewer",value:"Reviewer"},{label:"Approver",value:"Approver"},{label:"Creator",value:"Creator"}];function g(){var e,o;const[a,m]=(0,t.useState)(!1),[g,k]=(0,t.useState)([]),[w,f]=(0,t.useState)([]),[j,b]=(0,t.useState)(""),[C,D]=(0,t.useState)(""),[S,A]=(0,t.useState)(!1),[R,P]=(0,t.useState)(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),[N,M]=(0,t.useState)([]),[U,z]=(0,t.useState)([]),[T,E]=(0,t.useState)([]),[_,q]=(0,t.useState)(""),J=()=>{D(""),m(!1)},O=async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/documents/permissions?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});M(o.data)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}};return(0,t.useEffect)((()=>{var e;P(JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user"))),O(),(async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/users?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,"&roleId=2"),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(null===o||void 0===o?void 0:o.data,"UUUAUA");const a=[];for(const e of null===o||void 0===o?void 0:o.data)a.push({value:null===e||void 0===e?void 0:e.id,label:"".concat(null===e||void 0===e?void 0:e.firstName," ").concat(null===e||void 0===e?void 0:e.lastName)});f(a)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})(),(async()=>{try{var e;const o=await p().get("http://54.81.250.98:8083/api/documents/mdr?companyId=".concat(null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId),{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}}),a=[];for(const e of null===o||void 0===o?void 0:o.data)a.push({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title,DocumentPermissionId:null===e||void 0===e?void 0:e.DocumentPermissionId,departmentId:null===e||void 0===e?void 0:e.departmentId});k(a)}catch(o){console.error("Error fetching departments:",null===o||void 0===o?void 0:o.message)}})()}),[]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(s.c,{title:"Create Permissions",width:416,centered:!0,visible:a,onCancel:J,footer:null,closeIcon:(0,I.jsx)(v.M5$,{className:"remix-icon text-color-black-100",size:24}),children:(0,I.jsxs)(i.c,{layout:"vertical",name:"basic",children:[(0,I.jsx)(i.c.Item,{label:"MDR",name:"mdr",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.default,{options:g,value:C,onChange:e=>D(e)})}),(0,I.jsx)(i.c.Item,{label:"Users",name:"users",rules:[{required:!0,message:"Please select MDR"}],children:(0,I.jsx)(n.default,{options:w,value:j,onChange:e=>b(e)})}),(0,I.jsx)(i.c.Item,{label:"Permissions",name:"permissions",children:(0,I.jsx)(h.c.Group,{options:x,defaultValue:0,onChange:e=>{console.log("checked = ",e),E(e)}})}),(0,I.jsxs)(d.c,{children:[(0,I.jsx)(r.c,{md:12,span:24,className:"hp-pr-sm-0 hp-pr-12",children:(0,I.jsx)(c.c,{block:!0,type:"primary",htmlType:"submit",onClick:()=>(async()=>{try{var e,o;const a=await p().post("http://54.81.250.98:8083/api/documents/permissions",{masterDocumentId:C,userId:j,companyId:null===R||void 0===R||null===(e=R.user)||void 0===e?void 0:e.companyId,createDocument:null===T||void 0===T?void 0:T.includes("Creator"),reviewDocument:null===T||void 0===T?void 0:T.includes("Reviewer"),approveDocument:null===T||void 0===T?void 0:T.includes("Approver")},{headers:{Authorization:null===R||void 0===R?void 0:R.accessToken}});console.log(a),l.cp.success(null===a||void 0===a||null===(o=a.data)||void 0===o?void 0:o.message),D(""),b(""),E([]),O(),m(!1)}catch(a){"Request failed with status code 403"==(null===a||void 0===a?void 0:a.message)&&l.cp.error("Permission Denied to create document on this MDR")}})(),children:"Add"})}),(0,I.jsx)(r.c,{md:12,span:24,className:"hp-mt-sm-12 hp-pl-sm-0 hp-pl-12",children:(0,I.jsx)(c.c,{block:!0,onClick:J,children:"Cancel"})})]})]})}),(0,I.jsx)("div",{style:{textAlign:"right",marginBottom:"16px"},children:(0,I.jsx)(c.c,{type:"primary",onClick:()=>{m(!0)},disabled:1!=(null===R||void 0===R||null===(o=R.user)||void 0===o?void 0:o.roleId),children:"Add Permissions"})}),(0,I.jsx)(u.c,{columns:y,dataSource:N})]})}}}]);
//# sourceMappingURL=244.b04d5a34.chunk.js.map